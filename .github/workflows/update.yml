name: Update

on:
  workflow_dispatch:

jobs:
  execute:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            // Get a list of open issues
            const opts = github.rest.issues.listForRepo.endpoint.merge({
              ...context.issue,
            })
            const issues = await github.paginate(opts)

            const issue = issues.find(issue => issue.title === 'Testing test')

            console.log(issue.title)
            console.log(issue.id)
            console.log(issue.number)

            if (issue) {
              github.rest.issues.update({
                ...context.repo,
                issue_number: issue.number,
                body: 'This is a test',
              })
            } else {
              github.rest.issues.create({
                ...context.repo,
                title: 'Testing test',
                body: 'This is a test',
              })
            }
